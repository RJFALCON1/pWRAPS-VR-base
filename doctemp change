using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using TMPro;
using UnityEngine.UI;

public class PTInspectManager : MonoBehaviour
{
    [Header("Stand Placeholders")]
    public GameObject[] standPlaceholders; 

    [Header("Text Instructions")]
    public TextMeshPro[] standTexts;      

    [Header("Confirmation Button")]
    public Button confirmPositionButton;

    [Header("Position Logger")]
    public PositionLogger positionLogger;

    [Header("Patient Data")]
    public StatsHandler statsHandler;

    [Header("Tracker")]
    public GameObject chestTracker;

    private int currentStandPositionIndex = 0;

    void Start()
    {
        SetNextStandPosition();
    }

    void SetNextStandPosition()
    {
        if (currentStandPositionIndex >= standPlaceholders.Length)
        {
            // Hide all texts and placeholders if calibration is complete
            foreach (var text in standTexts)
                text.gameObject.SetActive(false);

            foreach (var stand in standPlaceholders)
                stand.SetActive(false);

            confirmPositionButton.gameObject.SetActive(false);
            return;
        }

        // Deactivate all stand placeholders and texts
        for (int i = 0; i < standPlaceholders.Length; i++)
        {
            standPlaceholders[i].SetActive(i == currentStandPositionIndex);
            standTexts[i].gameObject.SetActive(i == currentStandPositionIndex);
        }

        // Set instruction text for the current stand
        standTexts[currentStandPositionIndex].text = "Move the stand here!";
    }

    public void ConfirmStandPosition()
    {
        // Log the position for debugging purposes
        Vector3 trackerPosition = chestTracker.transform.position;
        positionLogger.SavePosition(trackerPosition);
        Debug.Log($"Confirmed tracker position: {trackerPosition}");

        // Move to the next stand
        currentStandPositionIndex++;

        // Call to update which stand/text is active
        SetNextStandPosition();
    }
}

